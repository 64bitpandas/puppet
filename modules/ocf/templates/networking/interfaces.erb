auto lo
iface lo inet loopback

<% if @ipaddress -%>
<% if @bridge -%>
auto br0
iface br0 inet manual
  bridge_ports eth0
  bridge_stp off
  bridge_maxwait 0
<% else -%>
auto eth0
iface eth0 inet manual
<% end -%>

<% if @bridge %>
auto br0.695
iface br0.695 inet static<% else %>
auto eth0.695
iface eth0.695 inet static<% end %>
  address <%= @ipaddress %>
  netmask <%= @netmask %>
  gateway <%= @gateway %>

<% if @bridge %>
auto br0.635
iface br0.635 inet static<% else %>
auto eth0.635
iface eth0.635 inet static<% end %>
  address <%= @newip %>
  netmask <%= @netmask %>

<% else -%>
auto eth0
iface eth0 inet manual

auto eth0.695
iface eth0.695 inet dhcp

auto eth0.635
iface eth0.635 inet dhcp
<% end -%>
