#!/bin/sh

/usr/bin/aptitude update > /dev/null

# remove downloaded package archives, unused packages, and old config files
/usr/bin/aptitude clean > /dev/null
/usr/bin/aptitude purge --assume-yes --quiet '?garbage' > /dev/null
/usr/bin/aptitude purge --assume-yes --quiet '?config-files' > /dev/null

# debsecan reports packages missing security updates
# report format is not quiet (see Debian bug #588065)
/usr/bin/debsecan --suite <%= lsbdistcodename %> --format detail --only-fixed | grep -Fv -e 'fixed in unstable' -e 'fix is available for the selected suite'
<% if desktop -%>

# update-flashplugin-nonfree updates Adobe Flash Player
[ -x /usr/sbin/update-flashplugin-nonfree ] && /usr/sbin/update-flashplugin-nonfree --install --quiet || exit 0
<% end -%>
